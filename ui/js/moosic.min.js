var startup=function(){vioSocket.init(),uiTools.init(),router.init()};document.addEventListener("DOMContentLoaded",function(){vioSocket.on("connect",startup),vioSocket.open("192.168.56.101")});var dataTools=function(){var e={};return{changeState:function(t){var i=Object.keys(t).filter(i=>void 0===this._state||!(i in e)||t[i]!==e[i]);return 0===i.length?[]:(e=t,i)},formatTime:function(e){var t=e;return(t-(t%=60))/60+(t>9?":":":0")+t},getStatus:function(){return"status"in e?e.status:""},getState:function(){return e},getQuality:function(e,t){return void 0!==e&&""!==e?void 0!==t&&""!==t?e.replace(" ","")+" | "+t.replace(" ",""):e.replace(" ",""):void 0!==t&&""!==t?t.replace(" ",""):""},getQueuePosition:function(){return e.position}}}(),domBuilder=function(){var e=window.crel.proxy,t="";window.crel.attrMap.on=((e,t)=>{for(const i in t)e.addEventListener(i,t[i])});var i=function(t,{msg:i}={}){var s=document.querySelector(".pageloader");!0===t&&null==s?(s=e.div({class:"pageloader"},e.p({class:"title"},i)),document.body.appendChild(s),window.setTimeout(()=>{s.classList.add("is-active")},200)):!1===t&&null!==s&&(s.classList.remove("is-active"),window.setTimeout(()=>{s.remove()},310))},s=function({href:t,image:i,title:s,subtitle:a}={}){return e.a({class:"column is-2-desktop is-4-mobile",href:t,"data-navigo":""},e.figure({class:"image is-1by1 albumart"},e.img({src:i})),e.div({class:"detail"},e.p({class:"has-text-weight-semibold is-capitalized"},s),void 0!==a?e.p(a):null))},a=function(t){return e.tr({"data-uri":t.uri,"data-title":t.title,"data-service":t.service},"tracknumber"in t?e.td({class:"pointer",on:{click:uiTools.handlers.tracks}},t.tracknumber):null,e.td({class:"pointer",on:{click:uiTools.handlers.tracks}},t.title),"trackType"in t?null:e.td(t.artist),"trackType"in t?null:e.td(t.album),t.trackType?e.td(e.figure({class:"image filetype"},e.img({src:"/img/icons/"+t.trackType.toLowerCase()+".svg"}))):null,t.duration?e.td(uiTools.formatTime(t.duration)):null,e.td(e.div({class:"dropdown is-right"},e.div({class:"dropdown-trigger"},e.button({"aria-haspopup":!0,on:{click:uiTools.handlers.dropdown}},e.img({src:"/img/icons/ellipsis.svg"}))),e.div({class:"dropdown-menu",role:"menu"},e.div({class:"dropdown-content"},e.span({class:"dropdown-item",on:{click:uiTools.handlers.playSong}},"Play"),e.span({class:"dropdown-item",on:{click:uiTools.handlers.queueSong}},"Add to queue"),e.span({class:"dropdown-item",on:{click:uiTools.handlers.replaceWithSong}},"Clear and play"),e.span({class:"dropdown-item"},"Add to playlist"),e.span({class:"dropdown-item",on:{click:uiTools.handlers.addFavorite}},"Add to favorites"))))))},o=function(t){var i=e.div({class:"buttons has-addons"});return["Playlists","Files","Artists","Albums","Genres"].forEach(function(s,a){i.appendChild(e.a({class:"button"+(t===s.replace(" ","").toLowerCase()?" is-selected is-primary":" is-light"),href:""+encodeURIComponent(s.replace(" ","").toLowerCase()),"data-navigo":""},s))}),i},l={setLoad:function(e){t=e,"home"===e?uiTools.showBackground(!0):uiTools.showBackground(!1)},build:function(i){var l=t,n=l,c=uiTools.clearNodes("#page-content");switch(l){case"home":var r=dataTools.getState(),d=dataTools.getQuality();c.appendChild(e.div({class:"columns is-multiline is-mobile home"},e.div({class:"column is-6-desktop is-offset-3-desktop is-10-mobile is-offset-1-mobile"},e.div({class:"columns"},e.div({class:"column is-6-desktop is-offset-3-desktop is-8-mobile is-offset-2-mobile"},e.figure({class:"image albumart"},e.img({src:vioSocket.getURL(r.albumart)})))),e.h2({class:"title"},r.title),e.h5({class:"artist"},r.artist),e.h5({class:"album"},r.album),e.h5({class:"detail"},d),e.figure({class:"image stream"},e.img({src:"stream"in r?"img//icons/"+r.stream+".svg":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"})))));break;case"files":n="Files",i=i.navigation.lists[0].items;var u=router.lastRoute().url;""!==(u=u.substr(u.indexOf("file")+5,u.length))&&(u+="/");var p=document.createDocumentFragment();p.appendChild(o(l)),p.appendChild(e.div({class:"columns is-mobile is-multiline artist-list"},i.filter(function(e){if("folder"===e.type)return e}).map(function(e){return s({title:e.title,image:vioSocket.getURL(e.albumart),href:"file/"+u+encodeURIComponent(e.title)})}))),p.appendChild(e.table({class:"table is-fullwidth songs songs-hover"},e.tbody(i.filter(function(e){if("song"===e.type)return e}).map(function(e){return a(e)})))),c.appendChild(p);break;case"album":n=i.navigation.info.album;var m=i.navigation.lists[0].items,v=i.navigation.info;(p=document.createDocumentFragment()).appendChild(e.div({class:"columns is-multiline is-mobile album-detail"},e.div({class:"column is-4-desktop is-12-mobile"},e.figure({class:"image is-1by1 albumart"},e.img({src:vioSocket.getURL(v.albumart)}))),e.div({class:"column is-8-desktop is-12-mobile"},e.h5({class:"is-uppercase has-text-weight-semibold"},"Album"),e.h2({class:"title album-title has-text-weight-semibold"},v.album),e.h5("By ",e.a({class:"artist has-text-weight-semibold","data-navigo":"",href:"artist/"+encodeURIComponent(v.artist)},v.artist)),e.h5({class:"detail"},m.length+" Song"+(m.length>1?"s":"")+" - "+v.duration+" - "+v.year),e.span({class:"tags"}),e.table({class:"table is-fullwidth songs songs-hover"},e.tbody(m.map(function(e){return a(e)})))))),c.appendChild(p);break;case"albums":var g=i.navigation.lists[0].items;(p=document.createDocumentFragment()).appendChild(o(l)),p.appendChild(e.div({class:"columns is-mobile is-multiline album-list"},g.map(function(e){return s({title:e.title,subtitle:e.artist,image:vioSocket.getURL(e.albumart),href:"album/"+encodeURIComponent(e.artist)+"/"+encodeURIComponent(e.title)})}))),c.appendChild(p);break;case"artist":n=i.navigation.info.title,g=i.navigation.lists[0].items;var f=(m=i.navigation.lists[1].items).filter(function(e){if(""===e.album)return e});v=i.navigation.info,(p=document.createDocumentFragment()).appendChild(e.div({class:"columns artist-info"},e.div({class:"column is-2"},e.figure({class:"image"},e.img({src:vioSocket.getURL(v.albumart)}))),e.div({class:"column is-4"},e.h5({class:"is-uppercase has-text-weight-semibold"},"Artist"),e.h2({class:"title has-text-semibold"},i.navigation.info.title),e.h5({class:"detail"},g.length+" album"+(g.length>1||0===g.length?"s":"")+" - "+m.length+" track"+(m.length>1?"s":""))))),p.appendChild(e.div({class:"columns is-mobile is-multiline album-list"},g.map(function(e){return s({title:e.title,image:vioSocket.getURL(e.albumart),href:"album/"+encodeURIComponent(e.artist)+"/"+encodeURIComponent(e.title)})}))),p.appendChild(e.table({class:"table is-fullwidth songs songs-hover"},e.tbody(f.filter(function(e){if(""===e.album)return e}).map(function(e){return a(e)})))),c.appendChild(p);break;case"artists":var h=i.navigation.lists[0].items;(p=document.createDocumentFragment()).appendChild(o(l)),p.appendChild(e.div({class:"columns is-mobile is-multiline artist-list"},h.map(function(e){return s({title:e.title,image:vioSocket.getURL(e.albumart),href:"artist/"+encodeURIComponent(e.title)})}))),c.appendChild(p);break;case"genres":var b=i.navigation.lists[0].items;(p=document.createDocumentFragment()).appendChild(o(l)),p.appendChild(e.div({class:"columns is-mobile is-multiline artist-list"},b.map(function(e){return s({title:e.title,image:"/img/icons/playlist-padded.svg",href:"genre/"+encodeURIComponent(e.title)})}))),c.appendChild(p);break;case"genre":n=router.lastRoute().params.genre,(i=i.navigation.lists).forEach(function(t){var i=e.div({class:"columns is-mobile is-multiline artist-list"});if(t.title.indexOf("Tracks")>0){var o="artist";0===t.title.indexOf("Albums")&&(o="album"),t.items.forEach(e=>{var t=o;"album"===t&&(t=t+"/"+encodeURIComponent(e.artist.trim())),i.appendChild(s({title:e.title,image:vioSocket.getURL(e.albumart),href:t+"/"+encodeURIComponent(e.title)}))})}else{var l=e.tbody();t.items.forEach((e,t)=>{l.appendChild(a(e))}),i.appendChild(e.table({class:"table is-fullwidth songs songs-hover"},l))}(p=document.createDocumentFragment()).appendChild(e.p({class:"title"},t.title)),p.appendChild(i),c.appendChild(p)});break;case"playlists":(p=document.createDocumentFragment()).appendChild(o(l)),i.unshift("favorites"),p.appendChild(e.div({class:"columns is-mobile is-multiline playlist-list"},i.map(function(e){return s({title:e,image:"/img/icons/playlist-padded.svg",href:"playlist/"+encodeURIComponent(e)})}))),c.appendChild(p);break;case"playlist":n="name"in i?i.name:"Favorites",p=document.createDocumentFragment(),m=[],i.lists&&i.lists.length>0?m=i.lists[0]:"navigation"in i&&"lists"in i.navigation&&i.navigation.lists[0].items.length>0&&(m=i.navigation.lists[0].items);var y="";y="navigation"in i?i.navigation.info.name:i.name,c.appendChild(e.div({class:"columns is-multiline is-mobile playlist-detail"},e.div({class:"column is-4-desktop is-12-mobile"},e.figure({class:"image is-1by1 albumart"},e.img({src:"/img/icons/playlist-padded.svg"}))),e.div({class:"column is-8-desktop is-12-mobile"},e.h5({class:"is-uppercase has-text-weight-semibold"},"Playlist"),e.h2({class:"title album-title has-text-weight-semibold is-capitalized"},y),e.table({class:"table is-fullwidth songs songs-hover"},e.tbody(m.map(t=>e.tr(e.td(e.figure({class:"image is-32x32"},e.img({src:vioSocket.getURL(t.albumart)}))),e.td(t.title),e.td(e.a({href:"artist/"+encodeURIComponent(t.artist)},t.artist)),e.td(e.a({href:"album/"+encodeURIComponent(t.artist)+"/"+encodeURIComponent(t.album)},t.album)))))))))}uiTools.setPageTitle({title:n}),router.update()},updateState:function(e){var i=dataTools.changeState(e),s=dataTools.getState();if(i.includes("albumart")){var a=vioSocket.getURL(s.albumart);document.querySelector("footer .albumart").src=a,document.getElementById("background").style.backgroundImage='url("'+a+'")'}if(i.includes("title")&&(document.querySelector("footer .song-title").innerText=s.title),i.includes("artist")&&(document.querySelector("footer .artist").innerText=s.artist),i.includes("repeat")&&(!0===s.repeat?document.querySelector("footer .play-controls .repeat").classList.add("has-text-primary"):document.querySelector("footer .play-controls .repeat").classList.remove("has-text-primary")),i.includes("repeatSingle")){var o="repeat";!0===s.repeatSingle&&(o+="-one"),document.querySelector("footer .repeat use").setAttribute("xlink:href","/node_modules/feather-icons/dist/feather-sprite.svg#"+o)}if(i.includes("random")&&(!0===s.random?document.querySelector("footer .play-controls .random").classList.add("has-text-primary"):document.querySelector("footer .play-controls .random").classList.remove("has-text-primary")),i.includes("status")){var n=document.querySelector(".state-icon use");"play"===s.status?(n.setAttribute("xlink:href","/node_modules/feather-icons/dist/feather-sprite.svg#pause"),n.parentNode.parentNode.classList.add("playing"),uiTools.progress.startCounting()):(n.setAttribute("xlink:href","/node_modules/feather-icons/dist/feather-sprite.svg#play"),n.parentNode.parentNode.classList.remove("playing"),uiTools.progress.stopCounting()),uiTools.setPageTitle({state:s})}if(i.includes("seek"))if("_seek"in uiTools.progress)uiTools.progress.set(s.seek,s.duration);else{var c=Math.round(Math.round(s.seek/1e3)/s.duration*1e3);isNaN(c)||(document.querySelector("footer progress").value=c)}(i.includes("status")||i.includes("title"))&&vioSocket.get.queue(),"home"===t&&(l.build("home"),uiTools.setPageTitle())},settings:function(t){var s=uiTools.clearNodes("#page-content"),a=e.div({class:"tabs"},e.ul(["library","playback","appearance","system","plugins","alarm","sleep","help"].map(i=>e.li({class:t===i?"is-active":""},e.a({href:"settings/"+i,"data-navigo":"",class:"is-capitalized"},i)))));s.appendChild(a);var o=e.div({id:"setting-page"});switch(t){case"library":uiTools.setPageTitle("Library Setttings");var l=document.createDocumentFragment();l.appendChild(e.div({class:"box"},e.p({class:"title"},"Database"),e.div({class:"field is-horizontal"},e.div({class:"field-label"},e.label({class:"label"},"Songs")),e.div({class:"field-body"},e.div({class:"field song-count"},"Loading"))),e.div({class:"field is-horizontal"},e.div({class:"field-label"},e.label({class:"label"},"Artists")),e.div({class:"field-body"},e.div({class:"field artist-count"},"Loading"))),e.div({class:"field is-horizontal"},e.div({class:"field-label"},e.label({class:"label"},"Albums")),e.div({class:"field-body"},e.div({class:"field album-count"},"Loading"))),e.div({class:"field is-horizontal"},e.div({class:"field-label"}),e.div({class:"field-body"},e.div({class:"field"},e.div({class:"control"},e.div({class:"buttons"},e.button({class:"button is-primary",on:{click:()=>{vioSocket.action.updateLibrary()}}},"Update Library"),e.button({class:"button is-primary",on:{click:()=>{vioSocket.action.rescanLibrary()}}},"Rescan Library"),e.button({class:"button is-primary",on:{click:()=>{vioSocket.action.updateMetadata()}}},"Update Metadata")))))))),l.appendChild(e.div({class:"box"},e.p({class:"title"},"Network shares"),e.div({class:"field is-horizontal"},e.div({class:"field-label"}),e.div({class:"field-body"},e.div({class:"field"},e.div({class:"control"},e.div({class:"buttons"},e.button({class:"button is-primary",on:{click:function(){n.addShare()}}},"Add share")))))))),o.appendChild(l),vioSocket.get.libraryStats(e=>{o.querySelector(".field.song-count").innerText=e.songs,o.querySelector(".field.artist-count").innerText=e.artists,o.querySelector(".field.album-count").innerText=e.albums});break;case"playback":uiTools.setPageTitle("Playback Setttings"),(l=document.createDocumentFragment()).appendChild(e.div({class:"box"},e.p({class:"title"},"Audio"),e.div({class:"field is-horizontal"},e.div({class:"field-label"},e.label({class:"label"},"Playback device")),e.div({class:"field-body"},e.div({class:"field"},e.div({class:"select",id:"playback-device"})))))),o.appendChild(l),vioSocket.get.audioDevices(t=>{var i=document.querySelector("#playback-device");if(void 0!==i&&t){var s=t.devices.active.id,a=t.devices.available.map(t=>e.option({"data-id":t.id,selected:t.id===s?"true":"false"},t.name));uiTools.clearNodes(i),i.appendChild(e.select(a))}});break;case"system":uiTools.setPageTitle("System Setttings"),(l=document.createDocumentFragment()).appendChild(e.div({class:"box"},e.p({class:"title"},"General"),e.div({class:"field is-horizontal"},e.div({class:"field-label"},e.label({class:"label"},"Device name")),e.div({class:"field-body"},e.div({class:"field  has-addons",id:"device-name"},e.div({class:"control"},e.input({class:"input",type:"text",on:{keyup:function(){this.parentNode.querySelector("button").classList.remove("is-hidden")}}})),e.div({class:"control"},e.button({class:"button is-primary",on:{click:function(){vioSocket.set.deviceName(this.parentNode.querySelector("input").value)}}},uiTools.getSVG("save")))))),e.div({class:"field is-horizontal"},e.div({class:"field-label"},e.label({class:"label"},"Version")),e.div({class:"field-body"},e.div({class:"field",id:"system-version"},e.p(e.span(),e.button({class:"button is-small is-primary",on:{click:function(){vioSocket.action.updateCheck(),this.classList.add("is-info"),this.classList.add("is-loading")}}},uiTools.getSVG("rotate-cw")))))),e.div({class:"field is-horizontal"},e.div({class:"field-label is-normal"},e.label({class:"label"},"Power")),e.div({class:"field-body"},e.div({class:"field"},e.div({class:"control"},e.div({class:"buttons"},e.button({class:"button is-danger",on:{click:()=>{vioSocket.action.reboot(),i(!0,{msg:"Rebooting"})}}},"Reboot"),e.button({class:"button is-danger",on:{click:()=>{vioSocket.action.shutdown(),i(!0,{msg:"Powering down"})}}},"Shutdown")))))))),o.appendChild(l),vioSocket.get.version(e=>{var t=document.querySelector("#system-version p span");if(void 0!==t&&e){var i=e.systemversion+" ("+e.builddate+") ";t.innerText=i}}),vioSocket.get.deviceName(e=>{var t=document.querySelector("#device-name input");void 0!==t&&e&&(t.value=e.name)})}s.appendChild(o),router.update()}},n={addShare:function(){var t=e.div({id:"update-detail-modal",class:"modal modal-fx-3dSignDown"},e.div({class:"modal-background"}),e.div({class:"modal-content"},e.div({class:"box is-paddingless"},e.div({class:"columns is-paddingless is-marginless"},e.div({class:"corner-image has-background-light is-paddingless is-hidden-mobile"},e.p({class:"title"},"Add Share"),e.img({src:"/img/modal-corner-add.svg"})),e.div({class:"column"},e.p("Music library"),e.p({class:"title"},"Add share"),e.div({class:"field"},e.div({class:"control"},e.input({class:"input name",type:"text",placeholder:"Share name"})),e.p({class:"help is-danger"})),e.div({class:"field"},e.div({class:"control"},e.input({class:"input address",type:"text",placeholder:"IP address"})),e.p({class:"help is-danger"})),e.div({class:"field"},e.div({class:"control"},e.input({class:"input path",type:"text",placeholder:"Path (e.g. /export/music)"})),e.p({class:"help is-danger"})),e.div({class:"field"},e.div({class:"control"},e.div({class:"select is-fullwidth"},e.select({class:"type"},e.option({value:"nfs"},"NFS"),e.option({value:"smb"},"SMB")))),e.p({class:"help is-danger"})),e.div({class:"field"},e.div({class:"control"},e.input({class:"input username",type:"text",placeholder:"Username"})),e.p({class:"help is-danger"})),e.div({class:"field"},e.div({class:"control"},e.input({class:"input password",type:"password",placeholder:"Password"})),e.p({class:"help is-danger"})),e.div({class:"field"},e.div({class:"control"},e.input({class:"input options",type:"text",placeholder:"Options"})),e.p({class:"help is-danger"})),e.div({class:"field first-button"},e.div({class:"control"},e.button({class:"button is-primary is-fullwidth",on:{click:function(){uiTools.handlers.addShare(this)}}},"Add"))),e.div({class:"field"},e.div({class:"control"},e.button({class:"button is-text is-fullwidth",on:{click:function(){this.closest(".modal").classList.remove("is-active")}}},"Close"))))))));uiTools.clearNodes("#modal-container").appendChild(t),window.setTimeout(()=>{t.classList.add("is-active")},250)}};return{queueTable:function(t){for(var i=uiTools.clearNodes("#queue tbody"),s=document.createDocumentFragment(),a=dataTools.getStatus(),o=dataTools.getQueuePosition(),l=0;l<=t.length-1;l++)s.appendChild(e.tr({"data-position":l,class:l===o?"is-playing":""},e.td(e.figure({class:"image albumart "+a+" is-32x32"},e.img({src:vioSocket.getURL(t[l].albumart)}))),e.td({class:"song-title","data-qp":o,on:{click:function(){vioSocket.play(this.closest("tr").dataset.position)}}},e.span(t[l].name),e.span(t[l].artist+" - "+t[l].album)),e.td({class:"duration"},uiTools.formatTime(t[l].duration)),e.td({class:"remove",on:{click:uiTools.handlers.removeSong}},e.span({class:"delete"}))));i.appendChild(s)},page:l}}(),router=function(){var e=new window.Navigo("/",!1,"#");return{update:function(){e.updatePageLinks()},lastRoute:function(){return e.lastRouteResolved()},init:function(){e.updatePageLinks(),e.on({playlists:function(){domBuilder.page.setLoad("playlists"),vioSocket.get.playlists()},"playlist/favorites":function(){domBuilder.page.setLoad("playlist"),vioSocket.get.favorites()},"playlist/:playlist":function(e){domBuilder.page.setLoad("playlist"),vioSocket.get.favorites(e.playlist)},files:function(){domBuilder.page.setLoad("files"),vioSocket.get.files()},"file/:location":function(e){domBuilder.page.setLoad("files"),vioSocket.get.files("/"+encodeURI(e.location))},"file/:location/*":function(t,i){var s=decodeURI(e.lastRoute().url);s=s.substr(s.indexOf("file/")+4,s.length),domBuilder.page.setLoad("files"),vioSocket.get.files(s)},artists:function(){domBuilder.page.setLoad("artists"),vioSocket.get.artists()},"artist/:artist":function(e){domBuilder.page.setLoad("artist"),vioSocket.get.artists(encodeURIComponent(e.artist))},albums:function(){domBuilder.page.setLoad("albums"),vioSocket.get.albums()},"album/:artist/:album":function(e){domBuilder.page.setLoad("album"),vioSocket.get.albums(encodeURIComponent(e.artist)+"/"+encodeURIComponent(e.album))},genres:function(){domBuilder.page.setLoad("genres"),vioSocket.get.genres()},"genre/:genre":function(e){domBuilder.page.setLoad("genre"),vioSocket.get.genres(encodeURIComponent(e.genre))},"settings/:page":function(e){domBuilder.page.setLoad("settings"),domBuilder.page.settings(e.page)},settings:function(){e.navigate("settings/library")},"*":function(){domBuilder.page.setLoad("home"),void 0!==dataTools.getState()&&0!==Object.keys(dataTools.getState()).length&&(domBuilder.page.build("home"),uiTools.setPageTitle("Audiophile Music Player"))}}).resolve()}}}(),uiTools=function(){var e="",t=!1,i=!1,s=!1;return{clearNodes:function(e){for("string"==typeof e&&(e=document.querySelector(e));e.firstChild;)e.firstChild.remove();return e},getSVG:function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.classList.add("feather");var i=document.createElementNS("http://www.w3.org/2000/svg","use");return i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","/node_modules/feather-icons/dist/feather-sprite.svg#"+e),t.appendChild(i),t},setPageTitle:function({title:t,state:i}={}){var s="";void 0!==t?(e=t,s=t):s=e,void 0!==i&&"play"===i.status&&(s=i.title+" - "+i.artist),s=void 0!==s?s.charAt(0).toUpperCase()+s.slice(1):"Audiophile Music Player",document.title=s+" | Moosic"},progress:{stopCounting:function(){clearInterval(t),i=!1,s=!1},startCounting:function(){var e=dataTools.getState();i=e.seek,s=e.duration,t=setInterval(()=>{i+=100;var e=Math.round(Math.round(i/100)/s*100);isNaN(e)||e===1/0||(document.querySelector("footer progress").value=e)},100)},set:function(e,t){i=e,s=t}},formatTime:function(e){return(e-(e%=60))/60+(e>9?":":":0")+e},showBackground:function(e){document.getElementById("background").style.visibility=!0===e?"visible":"hidden"},handlers:{tracks:function(e){for(var t=this.closest("tbody").querySelectorAll("tr"),i=[],s=0,a=this.closest("tr").dataset.uri,o=0;o<t.length;o++)i.push({uri:t[o].dataset.uri}),t[o].dataset.uri===a&&(s=o);vioSocket.action.replaceAndPlay(i,s)},dropdown:function(e){this.closest(".dropdown").classList.toggle("is-active")},removeSong:function(e){var t=this.closest("tr").dataset.position;vioSocket.action.removeFromQueue(t)},playSong:function(e){vioSocket.action.addPlay({uri:this.closest("tr").dataset.uri}),this.closest(".dropdown").classList.remove("is-active")},queueSong:function(e){var t=[{uri:this.closest("tr").dataset.uri}];vioSocket.action.enqueue(t),this.closest(".dropdown").classList.remove("is-active")},replaceWithSong:function(e){vioSocket.action.replaceAndPlay([{uri:this.closest("tr").dataset.uri}]),this.closest(".dropdown").classList.remove("is-active")},addFavorite:function(e){var t=this.closest("tr").dataset;vioSocket.action.addToFavorites({uri:t.uri,title:t.title,service:t.service})},addShare:function(e){var t=e.closest(".column"),i={name:t.querySelector(".name").value,ip:t.querySelector(".address").value,path:t.querySelector(".path").value,fstype:t.querySelector(".type").value,username:t.querySelector(".username").value,password:t.querySelector(".password").value,options:t.querySelector(".options").value};vioSocket.action.addShare(i)}},init:function(){document.querySelector("footer .right .show-queue").addEventListener("click",function(e){document.getElementById("queue").classList.add("is-active")}),document.addEventListener("swiped-left",function(e){e.preventDefault(),document.getElementById("queue").classList.add("is-active")}),document.querySelector("#queue").addEventListener("swiped-right",function(e){e.preventDefault(),document.getElementById("queue").classList.remove("is-active")}),document.querySelector(".quickview-header .delete").addEventListener("click",function(){this.closest(".quickview").classList.remove("is-active")}),document.querySelector("footer .state-container").addEventListener("click",function(e){this.classList.contains("playing")?vioSocket.action.pause():vioSocket.action.play()}),document.querySelector("footer .play-controls .repeat").addEventListener("click",function(e){vioSocket.action.toggleRepeat()}),document.querySelector("footer .next-icon").addEventListener("click",function(e){vioSocket.action.next()}),document.querySelector("footer .prev-icon").addEventListener("click",function(e){vioSocket.action.prev()}),document.querySelector("footer .play-controls .random").addEventListener("click",function(e){vioSocket.action.toggleRandom()})}}}(),vioSocket=function(){var e=[],t="",i=!1,s=function(e){void 0!==e&&i.emit(e)},a=function(e,t){void 0!==e&&void 0!==t&&i.emit(e,t)},o=function(t,s){return e[t]=s,!1!==i&&i.on(t,e[t]),e},l=function(e){a("browseLibrary",{uri:e})},n={state:function(){s("getState")},queue:function(){s("getQueue")},outputDevices:function(){s("getOutputDevices")},shares:function(){s("getListShares")},playlists:function(){s("listPlaylist")},favorites:function(){l("favourites://")},playlist:function(e){a("getPlaylistContent",{name:e})},files:function(e){l("music-library"+(void 0!==e?e:""))},artists:function(e){l("artists://"+(void 0!==e?e:""))},albums:function(e){l("albums://"+(void 0!==e?e:""))},genres:function(e){l("genres://"+(void 0!==e?e:""))},version:function(e){o("pushVersion",e),s("getVersion")},deviceName:function(e){o("pushDeviceName",e),s("getDeviceName")},audioDevices:function(e){o("pushOutputDevices",e),s("getOutputDevices")},libraryStats:function(e){o("pushMyCollectionStats",e),s("getMyCollectionStats")}};return{open:function(s){return t=s,window.loadJS("http://"+t+"/socket.io/socket.io.js",()=>{(i=io(s)).on("connect",()=>{"connect"in e&&e.connect()})}),!0},on:o,get:n,set:{deviceName:function(e){a("setDeviceName",{name:e})}},action:{clearQueue:function(){s("clearQueue")},addPlay:function(e,t){a("addPlay",{list:e,index:t=t||0})},replaceAndPlay:function(e,t){a("replaceAndPlay",{list:e,index:t=t||0})},enqueue:function(e){a("addToQueue",e)},removeFromQueue:function(e){a("removeFromQueue",{value:e})},saveQueue:function(e){void 0!==e&&a("saveQueueToPlaylist",{name:e})},play:function(e){void 0===e?s("play"):a("play",{value:e})},pause:function(){s("pause")},next:function(){s("next")},prev:function(){s("prev")},toggleRandom:function(){var e=dataTools.getState().random;a("setRandom",{value:!e})},toggleRepeat:function(){var e=dataTools.getState();!0===e.repeatSingle?a("setRepeat",{value:!1,repeatSingle:!1}):!0===e.repeat?a("setRepeat",{value:!0,repeatSingle:!0}):a("setRepeat",{value:!0,repeatSingle:!1})},updateLibrary:function(){s("updateDB")},rescanLibrary:function(){s("rescanDB")},updateMetadata:function(){s("updateAllMetadata")},updateCheck:function(){s("updateCheck")},update:function(){a("update",{value:"now "})},addToFavorites:function(e,t,i){e&&t&&i&&a("addToFavourites",{uri:e,title:t,service:i})},addShare:function({name:e,ip:t,path:i,fstype:s,username:o,password:l,options:n}={}){a("addShare",{name:e,ip:t,path:i,fstype:s,username:o,password:l,options:n})},shudown:function(){s("shutdown")},reboot:function(){s("reboot")}},getURL:function(e){return"http://"+t+e},init:function(){o("pushBrowseLibrary",domBuilder.page.build),o("pushListPlaylist",domBuilder.page.build),o("pushState",domBuilder.page.updateState),o("pushQueue",domBuilder.queueTable),n.state()}}}();